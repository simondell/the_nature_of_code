<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>A random walker and walker class</title>

	<style>
	canvas {
		border: 1px solid grey;
	}
	</style>
</head>
<body>
</body>

	<script src="random-0.26.js"></script>
	<script src="frames.js"></script>


	<script>
		(function( Frames, Random ){
			var canvasWidth = 640;
			var canvasHeight = 360;
			var context = null;

			function probablyExponential ( max ) {
				var r1, r2, probability;

				while ( true ) {
					r1 = Random.uniform( 0, max );
					probability = Math.pow( r1, 2);
					r2 = Math.pow( Random.uniform( 0, max ), 2);

					if( r2 < probability ) return r1;
				}
			}

			// A Walker "class"
			function Walker(context, x, y) {
				this.context = context;
				this.x = x;
				this.y = y;
			}

			Walker.prototype.step = function () {
				var max = 20;
				var stepSize = probablyExponential( max );

				this.new_x = this.x + Random.uniform( -stepSize, stepSize );
				this.new_y = this.y + Random.uniform( -stepSize, stepSize );

				return this;
			}

			Walker.prototype.display = function () {
				this.context.lineWidth = 1;
				this.context.strokeStyle = 'rgba(0,0,0,0.1)';
				this.context.moveTo( x, y );
				this.context.lineTo( this.new_x, this.new_y );
				this.context.stroke();

				this.x = this.new_x;
				this.y = this.new_y;

				return this;
			}


			//
			// get it walking
			//
			function setup () {
				context = Frames.setupCanvas( canvasWidth, canvasHeight );
				walker = new Walker( context, context.canvas.width / 2, context.canvas.height / 2 );
			}

			function draw () {
				walker.step().display();
			}

			Frames.go( setup, draw );

		})( Frames, new Random() );
	</script>
</html>